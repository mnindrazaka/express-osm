<html>

<head>
  <title>Open Street Map</title>
  <link rel="stylesheet" href="/public/vendor/leaflet/leaflet.css">
  <style>
    #map {
      height: 100%;
    }
  </style>
</head>

<body>
  <div id="map"></div>
  <script src="/public/vendor/leaflet/leaflet.js"></script>
  <script>
    var mymap = L.map('map').setView([-7.971526, 112.631373], 13)
    L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'
    }).addTo(mymap);

    // passing data dari controller ke script view
    const geojson = <%- JSON.stringify(geojson) %>;

    geojson.forEach(function (item) {

      // menukar latitude dan longitude
      for (let i = 0; i < item.coordinates.length; i++) {
        const temp = item.coordinates[i][0];
        item.coordinates[i][0] = item.coordinates[i][1]
        item.coordinates[i][1] = temp;
      }

      // menggambar peta
      L.polyline(item.coordinates, { color: item.color, opacity: 0.6, weight: 5}).bindPopup(`
        <h4>damage type : ${item.damage_type}</h4>
        <h4>damage level : ${item.damage_level}</h4>
        <p>${item.information}</p>
      `).addTo(mymap);
    })

  </script>
</body>

</html>